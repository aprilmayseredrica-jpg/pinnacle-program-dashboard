<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Pinnacle Program | Financials & ROI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        .main-title {
            color: #1e293b; /* slate-800 */
        }
        .subtitle {
            color: #475569; /* slate-600 */
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px_6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: all 0.3s ease-in-out;
        }
        .chart-title {
            color: #334155; /* slate-700 */
            font-weight: 600;
        }
        /* MMM Color Palette */
        .mmm-primary { color: #0f766e; } /* teal-700 */
        .mmm-secondary { color: #0d9488; } /* teal-600 */
        .mmm-accent { color: #f59e0b; } /* amber-500 */
        .mmm-gray { color: #64748b; } /* slate-500 */
        .mmm-primary-bg { background-color: #0f766e; }
        .mmm-accent-bg { background-color: #f59e0b; }
        .gemini-btn {
            background-color: #1e40af; /* blue-800 */
            color: white;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            transition: background-color 0.3s;
        }
        .gemini-btn:hover {
            background-color: #1d4ed8; /* blue-700 */
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #1e40af;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="p-4 sm:p-6 lg:p-8">

    <div class="max-w-6xl mx-auto">
        <header class="text-center mb-10">
            <h1 class="text-4xl font-extrabold main-title tracking-tight">The Pinnacle Program</h1>
            <p class="mt-2 text-lg subtitle">How It Works & Why It's Profitable</p>
        </header>

        <!-- Section 1: The Fee Structure -->
        <div class="mb-12">
            <h2 class="text-2xl font-bold text-center main-title mb-6">The Pinnacle Program Fee Schedule</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 text-center">
                <div class="card p-6 border-t-4 border-teal-600">
                    <p class="text-sm font-semibold text-gray-500">Tenure: 91 Days - 1 Year</p>
                    <p class="text-4xl font-bold main-title my-2">$25,000</p>
                    <p class="text-gray-600">Secures our initial investment and the full non-solicitation value.</p>
                </div>
                <div class="card p-6 border-t-4 border-teal-500">
                    <p class="text-sm font-semibold text-gray-500">Tenure: 1 - 2 Years</p>
                    <p class="text-4xl font-bold main-title my-2">$20,000</p>
                    <p class="text-gray-600">Rewards the first year of successful partnership.</p>
                </div>
                <div class="card p-6 border-t-4 border-teal-400">
                    <p class="text-sm font-semibold text-gray-500">Tenure: 2 - 3 Years</p>
                    <p class="text-4xl font-bold main-title my-2">$15,000</p>
                    <p class="text-gray-600">Recognizes a significant, multi-year client relationship.</p>
                </div>
                <div class="card p-6 border-t-4 border-amber-500">
                    <p class="text-sm font-semibold text-gray-500">Tenure: 3+ Years</p>
                    <p class="text-4xl font-bold main-title my-2">$10,000</p>
                    <p class="text-gray-600">Our premium rate for the most dedicated, long-term partners.</p>
                </div>
            </div>
        </div>

        <!-- Section 2: Financial Justification -->
        <div class="mb-12">
            <h2 class="text-2xl font-bold text-center main-title mb-6">Financial Justification: A Win-Win Model</h2>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-2 card p-6">
                    <h3 class="chart-title mb-4">Pinnacle Program Fee vs. MMM's Cumulative Profit</h3>
                    <canvas id="roiChart"></canvas>
                </div>
                <div class="card p-8 flex flex-col justify-center text-center bg-teal-50">
                     <h3 class="text-xl font-bold main-title mb-4">Projected Revenue</h3>
                     <p class="text-6xl font-extrabold mmm-primary">$1.66M</p>
                     <p class="mt-2 text-md font-semibold subtitle">In the first 20 Months</p>
                     <p class="text-sm text-gray-600 mt-4">Based on a conservative estimate of converting 20% of applicable VA resignations into Pinnacle Program partnerships.</p>
                </div>
            </div>
        </div>
        
        <!-- Section 3: Gemini API Powered Tools -->
        <div>
            <h2 class="text-2xl font-bold text-center main-title mb-6">✨ AI-Powered Success Tools</h2>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Buyout Readiness Analysis -->
                <div class="card p-6">
                    <h3 class="chart-title mb-4">Buyout Readiness Analysis</h3>
                    <p class="text-gray-600 mb-4">Enter a VA's tenure to get an AI-powered readiness score and justification.</p>
                    <div class="flex items-center gap-4">
                        <input type="number" id="tenureInput" placeholder="Enter VA Tenure (days)" class="w-full p-2 border border-gray-300 rounded-md">
                        <button id="analyzeBtn" class="gemini-btn flex-shrink-0">Analyze</button>
                    </div>
                    <div id="readinessResult" class="mt-6 text-center hidden">
                        <div id="readinessLoader" class="loader mx-auto my-4"></div>
                        <div id="readinessContent">
                             <p class="text-gray-600">Buyout Readiness Score</p>
                             <p id="readinessScore" class="text-7xl font-bold mmm-primary my-2"></p>
                             <p id="readinessJustification" class="text-gray-700 font-medium italic"></p>
                             <button id="talkingPointsBtn" class="gemini-btn mt-6">✨ Generate Talking Points</button>
                        </div>
                    </div>
                </div>

                <!-- Conversation Starters -->
                <div class="card p-6">
                     <h3 class="chart-title mb-4">Client Conversation Starters</h3>
                     <div id="talkingPointsResult" class="text-gray-600">
                         <p>AI-generated talking points for your client conversations will appear here.</p>
                     </div>
                     <div id="talkingPointsLoader" class="loader mx-auto my-4 hidden"></div>
                </div>
            </div>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Chart.js implementation
            const roiCtx = document.getElementById('roiChart').getContext('2d');
            new Chart(roiCtx, {
                type: 'bar',
                data: {
                    labels: ['Year 1', 'Year 2', 'Year 3', 'Year 4', 'Year 5'],
                    datasets: [
                        {
                            type: 'line',
                            label: 'Pinnacle Program Fee',
                            data: [25000, 20000, 15000, 10000, 10000],
                            borderColor: '#f59e0b',
                            backgroundColor: 'rgba(245, 158, 11, 0.2)',
                            borderWidth: 3,
                            pointBackgroundColor: '#f59e0b',
                            pointRadius: 5,
                            stepped: 'before',
                            order: 1
                        },
                        {
                            type: 'bar',
                            label: "MMM's Cumulative Profit",
                            data: [10236, 20779, 31638, 42823, 54344],
                            backgroundColor: '#0d9488',
                            borderRadius: 4,
                            order: 2
                        },
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { position: 'top' },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) { label += ': '; }
                                    if (context.parsed.y !== null) {
                                        label += new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 0 }).format(context.parsed.y);
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: (value) => '$' + (value / 1000) + 'k'
                            }
                        }
                    }
                }
            });

            // Gemini API Functionality
            const analyzeBtn = document.getElementById('analyzeBtn');
            const tenureInput = document.getElementById('tenureInput');
            const readinessResult = document.getElementById('readinessResult');
            const readinessLoader = document.getElementById('readinessLoader');
            const readinessContent = document.getElementById('readinessContent');
            const readinessScoreEl = document.getElementById('readinessScore');
            const readinessJustificationEl = document.getElementById('readinessJustification');
            
            const talkingPointsBtn = document.getElementById('talkingPointsBtn');
            const talkingPointsResult = document.getElementById('talkingPointsResult');
            const talkingPointsLoader = document.getElementById('talkingPointsLoader');

            const API_KEY = ""; // Keep this empty
            const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${API_KEY}`;
            
            let currentTenure = 0;

            async function callGeminiAPI(prompt, systemInstruction) {
                const payload = {
                    contents: [{ parts: [{ text: prompt }] }],
                    systemInstruction: { parts: [{ text: systemInstruction }] }
                };

                // Add exponential backoff for retries
                let response;
                let delay = 1000;
                for (let i = 0; i < 5; i++) {
                    try {
                        response = await fetch(API_URL, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });
                        if (response.ok) {
                             const result = await response.json();
                             return result.candidates?.[0]?.content?.parts?.[0]?.text || "No content generated.";
                        }
                         // Don't retry on client-side errors, only server-side
                        if (response.status < 500 && response.status !== 429) {
                            throw new Error(`API call failed with status: ${response.status}`);
                        }
                    } catch (error) {
                        console.error("Gemini API Error:", error);
                        // Stop retrying on critical errors
                        if (!response || (response.status < 500 && response.status !== 429) ) {
                             return "Error generating content. Please check the console.";
                        }
                    }
                    await new Promise(resolve => setTimeout(resolve, delay));
                    delay *= 2;
                }
                 return "API is currently unavailable. Please try again later.";
            }
            
            analyzeBtn.addEventListener('click', async () => {
                currentTenure = parseInt(tenureInput.value);
                if (!currentTenure || currentTenure <= 0) {
                    alert("Please enter a valid tenure in days.");
                    return;
                }

                readinessResult.classList.remove('hidden');
                readinessContent.classList.add('hidden');
                readinessLoader.classList.remove('hidden');
                talkingPointsResult.innerHTML = '<p>AI-generated talking points for your client conversations will appear here.</p>';

                const systemInstruction = "You are a business analyst for My Mountain Mover, a VA agency. Your task is to assess the likelihood of a client wanting to buy out their VA based on tenure. A longer tenure means a stronger relationship and higher value. Provide a 'Buyout Readiness Score' from 1-100 and a concise, one-sentence justification. Format your response as: SCORE | JUSTIFICATION";
                const prompt = `VA Tenure: ${currentTenure} days.`;
                
                const resultText = await callGeminiAPI(prompt, systemInstruction);
                
                const [score, justification] = resultText.split('|').map(s => s.trim());

                readinessScoreEl.textContent = score || 'N/A';
                readinessJustificationEl.textContent = justification || 'Could not generate justification.';
                
                readinessLoader.classList.add('hidden');
                readinessContent.classList.remove('hidden');
            });

            talkingPointsBtn.addEventListener('click', async () => {
                talkingPointsLoader.classList.remove('hidden');
                talkingPointsResult.innerHTML = '';
                
                let tierName = "91 Days - 1 Year";
                let fee = 25000;
                if (currentTenure > 1095) {
                    tierName = "3+ Years";
                    fee = 10000;
                } else if (currentTenure > 730) {
                    tierName = "2 - 3 Years";
                    fee = 15000;
                } else if (currentTenure > 365) {
                    tierName = "1 - 2 Years";
                    fee = 20000;
                }

                const systemInstruction = "You are an expert Client Success Manager at My Mountain Mover. Your goal is to help your colleagues proactively and positively discuss 'The Pinnacle Program' (a VA buyout option) with clients. Generate 3 distinct, concise, and strategic conversation starters for a client whose VA has been with them for a specific tenure. Frame it as a benefit and a long-term partnership opportunity. The tone should be professional, confident, and client-focused. Format as a numbered list.";
                const prompt = `The VA's tenure is ${currentTenure} days, which places them in the '${tierName}' buyout category with a fee of $${fee.toLocaleString()}.`;
                
                const resultText = await callGeminiAPI(prompt, systemInstruction);
                const points = resultText.split(/\d\.\s/).filter(p => p.trim() !== '');

                const list = document.createElement('ul');
                list.className = 'list-disc list-inside space-y-3';
                points.forEach(point => {
                    const item = document.createElement('li');
                    item.textContent = point.trim();
                    list.appendChild(item);
                });
                
                talkingPointsLoader.classList.add('hidden');
                talkingPointsResult.appendChild(list);
            });
        });
    </script>
</body>
</html>

